<html>
    <head>
        <title>Convolutional Neural Network</title>
        <link rel="stylesheet" href="blogs/blog3.css">
        <link href="https://fonts.googleapis.com/css?family=Baskervville|Muli&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Cookie&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Roboto+Slab&display=swap" rel="stylesheet"> 
        
    </head>
    <body>
        <div id="mainBorder">
                <div id="mainHeading">
                        Convolutional Neural Network
                </div>
                <div id="contentImages">
                        <center><img src="images/blog3/image1.png" width="700" height=""/></center>
                </div>
                <div id="majorHeading">
                        Introduction
                </div>

                <div id="mainBody">
                        Artificial Intelligence has been witnessing a monumental growth in bridging the gap between the capabilities of humans and machines. Researchers and enthusiasts alike, work on numerous aspects of the field to make amazing things happen. One of many such areas is the domain of Computer Vision.
                        <br /><br />
                        The advancements in Computer Vision with Deep Learning has been constructed and perfected with time, primarily over one particular algorithm — a Convolutional Neural Network. 
                        <br /><br />
                        Convolutional Neural Networks are very similar to ordinary Neural Networks: they are made up of neurons that have learnable weights and biases. Each neuron receives some inputs, performs a dot product and optionally follows it with a non-linearity. The whole network still expresses a single differentiable score function: from the raw image pixels on one end to class scores at the other. And they still have a loss function (e.g. SVM/Softmax) on the last (fully-connected) layer and all the tips/tricks we developed for learning regular Neural Networks still apply.
                        <br /><br />
                        So what changes? Let us first discuss this below.
                </div>
                <br /><br />
                <div id="majorHeading">
                        Difference between a regular Neural Network and a Convolutional Neural Network (CNN)?
                </div>
                <br/>
                <div id="defination">
                        ConvNet architectures make the explicit assumption that the inputs are images, which allows us to encode certain properties into the architecture. These then make the forward function more efficient to implement and vastly reduce the amount of parameters in the network.
                </div>

                <div id="mainBody">
                        Woah! Right? I know that was a lot to take in. But trust me and hold on.
                        <br /><br />
                        In simpler words, regular Neural Network are not good with real life data such as images, audio, etc.
                        <br /><br />
                        Regular Neural Networks receive an input (a single vector), and transform it through a series of hidden layers. Each hidden layer is made up of a set of neurons, where each neuron is fully connected to all neurons in the previous layer, and where neurons in a single layer function completely independently and do not share any connections. The last fully-connected layer is called the “output layer” and in classification settings it represents the class scores.
                        <br /><br />
                </div>
                        
                <div id="defination">
                        Regular Neural Network : 
                </div>
        
                <div id="contentImages">
                        <center><img src="images/blog3/image3.jpeg" width="450" height=""/></center>
                </div>

                
                <div id="mainBody">

                        As I mentioned earlier, Regular Neural Nets don’t scale well to full images. In CIFAR-10, images are only of size 32x32x3, so a single fully-connected neuron in a first hidden layer of a regular Neural Network would have 32*32*3 = 3072 weights. This amount still seems manageable, but clearly this fully-connected structure does not scale to larger images.
                        <br /><br />
                        For example, an image of more respectable size, e.g. 200x200x3, would lead to neurons that have 200*200*3 = 120,000 weights. Moreover, we would almost certainly want to have several such neurons, so the parameters would add up quickly! Clearly, this full connectivity is wasteful and the huge number of parameters would quickly lead to overfitting.
                </div>
               
                
                <div id="defination">
                        Convolutional Neural Network : 
                </div>
                <div id="contentImages">
                        <center><img src="images/blog3/image2.jpeg" width="450" height=""/></center>
                </div>


                <div id="mainBody">
                        Convolutional Neural Networks take advantage of the fact that the input consists of images and they constrain the architecture in a more sensible way. In particular, unlike a regular Neural Network, the layers of a ConvNet have neurons arranged in 3 dimensions: width, height, depth (channels like RGB). 
                        <br/><br/>
                        For example, the input images in CIFAR-10 are an input volume of activations, and the volume has dimensions 32x32x3 (width, height, depth respectively). As we will soon see, the neurons in a layer will only be connected to a small region of the layer before it, instead of all of the neurons in a fully-connected manner. 
                        <br/><br/>
                        Moreover, the final output layer would for CIFAR-10 have dimensions 1x1x10, because by the end of the ConvNet architecture we will reduce the full image into a single vector of class scores, arranged along the depth dimension.
                </div>

                <div id="majorHeading">
                        Layers used to build ConvNets
                </div>  

                <div id="mainBody">
                        1. A ConvNet architecture is in the simplest case a list of Layers that transform the image volume into an output volume (e.g. holding the class scores)
                        <br/><br/>2. There are a few distinct types of Layers (e.g. CONV/FC/RELU/POOL are by far the most popular)
                        <br/><br/>3. Each Layer accepts an input 3D volume and transforms it to an output 3D volume through a differentiable function
                        <br/><br/>4. Each Layer may or may not have parameters (e.g. CONV/FC do, RELU/POOL don’t)
                        <br/><br/>5. Each Layer may or may not have additional hyperparameters (e.g. CONV/FC/POOL do, RELU doesn’t)
                </div>

                <div id="majorHeading">
                        Convolutional Layer
                </div> 


                <div id="mainBody">
                        Convolution is the first layer to extract features from an input image. Convolution preserves the relationship between pixels by learning image features using small squares of input data. It is a mathematical operation that takes two inputs such as image matrix and a filter or kernel.                        
                        <br><br>
                </div>
                
                <div id="contentImages">
                        <center><img src="images/blog3/image3.png" width="400" height=""/></center>
                </div>

                <div id="mainBody">
                        Consider a 5 x 5 whose image pixel values are 0, 1 and filter matrix 3 x 3 as shown in below
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image4.png" width="400" height=""/></center>
                </div>

                <div id="mainBody">
                        In the below demonstration, the green section resembles our 5x5x1 input image, I. The element involved in carrying out the convolution operation in the first part of a Convolutional Layer is called the Kernel/Filter, K, represented in the color yellow. We have selected K as a 3x3x1 matrix.
                        <br><br>
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image12.gif" width="300" height=""/></center>
                </div>

                <div id="mainBody">
                        Here, the convolved feature is also called as 'feature map'.
                        <br><br>
                </div>

                <div id="majorHeading">
                        Strides
                </div>

                <div id="mainBody">
                        Stride is the number of pixels shifts over the input matrix. When the stride is 1 then we move the filters to 1 pixel at a time. When the stride is 2 then we move the filters to 2 pixels at a time and so on. The below figure shows convolution would work with a stride of 1.
                </div>

                <div id="defination">
                        Direction : 
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image12.png" width="200" height=""/></center>
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image13.gif" width="700" height=""/></center>
                </div>

                <div id="majorHeading">
                        Padding
                </div>

                <div id="mainBody">
                        There are two types of results to the operation — one in which the convolved feature is reduced in dimensionality as compared to the input, and the other in which the dimensionality is either increased or remains the same. This is done by applying <i>'Valid Padding'</i> in case of the former, or <i>'Same Padding'</i> in the case of the latter.
                </div>
               
                <div id="defination" style="font-size: 70px;">
                        Valid Padding :
                </div>

                <div id="contentImages" style="display: inline;">
                        <center><img src="images/blog3/image14.gif" width="300" height=""/></center>
                </div>

                <div id="mainBody">
                        (Notice how output image dimensionality is reduced)
                </div>

                <div id="defination" style="font-size: 70px;">
                        Same Padding : 
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image15.gif" width="300" height=""/></center>
                </div>

                <div id="mainBody">
                        (Notice how output image dimensionality is not changed)
                </div>


                <div id="majorHeading">
                        Pooling layer
                </div>

                <div id="mainBody">
                        Pooling layers section would reduce the number of parameters when the images are too large. Spatial pooling also called subsampling or downsampling which reduces the dimensionality of each map but retains important information. Spatial pooling can be of different types:
                        <br /><br />
                                # Max Pooling<br/>
                                # Average Pooling<br/>
                                # Sum Pooling<br/>
                        <br /><br />
                        Max pooling takes the largest element from the rectified feature map. Taking the largest element could also take the average pooling. Sum of all elements in the feature map call as sum pooling.
                </div>

                <div id="defination" style="font-size: 70px;">
                        Max pooling : 
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image16.gif" width="300" height=""/></center>
                </div>



                <div id="majorHeading">
                        Fully Connected layer
                </div>

                <div id="mainBody">
                        Ok, so this is easy.
                        <br /><br />
                        The layer we call as FC layer, we flattened our matrix into vector and feed it into a fully connected layer like a neural network.
                        <br /><br />
                        Adding a Fully-Connected layer is a (usually) cheap way of learning non-linear combinations of the high-level features as represented by the output of the convolutional layer. The Fully-Connected layer is learning a possibly non-linear function in that space.                
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image17.png" width="600" height=""/></center>
                </div>
                
                <div id="mainBody">
                        There are various architectures of CNNs available which have been key in building algorithms which power and shall power AI as a whole in the foreseeable future. Some of them have been listed below:
                        <br/>
                        <br/> 1. LeNet
                        <br/> 2. AlexNet
                        <br/> 3. VGGNet
                        <br/> 4. GoogLeNet
                        <br/> 5. ResNet
                        <br/> 6. ZFNet
                </div>

                <div id="defination">
                        Complete CNN stucture : 
                </div>

                <div id="contentImages">
                        <center><img src="images/blog3/image18.jpeg" width="1000" height=""/></center>
                </div>


                <div id="defination">
                        Conclusion : 
                </div>

                <div id="mainBody">
                        I hope this blog clears your doubts on CNN. All the best! 
                        <br/>
                        ~ Aryan
                </div>


        </div>
    </body>
</html>